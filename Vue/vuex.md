
# [Vuex](https://vuex.vuejs.org/)

Vuex это библиотека для управления состоянием приложений на Vue.js. Vuex позволяет создавать централизованное хранилище данных, которое реактивно отражает изменения в компонентах Vue. Vuex также предоставляет правила и механизмы для изменения состояния, такие как мутации, действия и геттеры. Vuex вдохновлен такими паттернами, как Flux, Redux и Архитектура Elm. Vuex разработан специально для Vue.js, чтобы использовать его систему реактивности для эффективного обновления. 

Полезная [статья](https://habr.com/ru/articles/421551/).

## [Установка Vuex](https://v3.vuex.vuejs.org/ru/installation.html)

> Если в проекте уже был установлен Vuex, то устанавливать его снова после установки Vue CLI не нужно.

```
npm install vuex@next --save
```

## [Создание хранилища](https://v3.vuex.vuejs.org/ru/guide/#%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%B5%D0%B8%D1%88%D0%B5%D0%B5-%D1%85%D1%80%D0%B0%D0%BD%D0%B8%D0%BB%D0%B8%D1%89%D0%B5)

По стандарту нужно создать в `src` папку `store`, и внутри него файл
`index.js`, в который импортируется функция `createStore` из `vuex`:

```js
import { createStore } from 'vuex'
export default createStore({
    ...
    })
```

C помощю функции `createStore` создается экземпляр класса `Vuex.Store`,
который экспортируется по умолчанию. 


## Добавление хранилища в приложение

Этот экземпляр класса `Vuex.Store` надо импортировать в `main.js`, дабы иметь доступ к нему, и установить хранилище как плагин в основном экземпляре `app` класса `Vue`:

```js
import store from './store'
app.use(store)
```

Тем самым мы обеспечиваем доступ к хранилищу во всех дочерних 
компонентах через `this.$store`. Эти инструкции должны идти перед монтированием `app.mount('#app')`.

## [State](https://v3.vuex.vuejs.org/ru/guide/state.html)

Vuex `state` это объект, который содержит состояние данных приложения на Vue.js. Vuex `state` можно сравнить с `data` в компонентах Vue, но с тем отличием, что `state` хранится в централизованном хранилище и доступен для всех компонентов приложения. Vuex `state` реактивен, то есть при изменении `state` автоматически обновляются все зависимые от него компоненты. 

>Для того, чтобы изменять `state`, нужно использовать мутации, которые являются синхронными функциями. Для асинхронных операций, таких как вызовы API, нужно использовать действия (`actions`).

```js
    state: {
        count: 0
    }
```

Для доступа к данным из приложений можно использовать функцию `mapState` в `computed`, которая автоматически генерирует вычисляемые свойства.
Так же можно получать доступ через 

```js
this.$store.state.<field_name>
```

## [Mutations](https://v3.vuex.vuejs.org/ru/guide/mutations.html)

Мутации изменяют значения данных хранилища. Мутации, в отличие от действий, должны быть синхронными. Мутации принимают в качестве первого аргумента `state`, а в качестве второго необязательного аргумента – полезную нагрузку `payload`.

```js
    mutations: {
    increment(state, payload) {
        state.count = state.count + payload;
    }
```

Мутации вызываются с помощью метода `store.commit`, который принимает первым аргументом имя мутации в виде строки, а вторым необязательным аргументом – полезную нагрузку (`payload`).


```js
    actions: {
    increment(context) {
        context.commit('increment', 5);
    }
```
Мутации желательно вызывать только в методах `action`. Не следует вызывать методы мутаций непосредственно из приложений. 

## [Actions](https://v3.vuex.vuejs.org/ru/guide/actions.html)
 
Действия используются для совершения асинхронных запросов на сервер и для  изменения данных хранилища, посредтсвом инициирования мутаций. Обработчик действия получает первым аргументом объект контекста, содержащий те же методы и свойства, что и сам экземпляр хранилища (`store`), так что вы можете вызвать `context.commit` для инициирования мутации или обратиться к состоянию и геттерам через `context.state` и `context.getters`. Однако, контекст – не то же самое, что экземпляр хранилища.

Действия запускаются с помощью метода `store.dispatch`, который может принимать имя действия в виде строки и нагрузку в качестве необязательного аргумента. Действия могут быть использованы в компонентах Vue с помощью `this.$store.dispatch` или с помощью вспомогательной функции `mapActions`, которая создает локальные псевдонимы для действий в виде методов компонента. Действия также могут быть композированы, то есть возвращать `Promise` или использовать `async`/`await` синтаксис, чтобы дожидаться завершения других действий.

>Названия методов действий и мутаций, которые вызываются в действиях принято делать одинаковыми.

## [Getters](https://v3.vuex.vuejs.org/ru/guide/getters.html)

Геттеры стоит использовать в тех случаях, когда необходимо получить модифицированные данные из хранилища. Для получения самих значений стоит использовать `...mapState` в `computed`. Первым аргументом геттеры получают объект хранилища (`state`)

```js
    getters: {
        currentTask(state) {
            return state.tasks.find(item => item.id == state.currentTaskId)
        }
    }
```